# Ffuf

| **Command**                                                                                                                                                     | **Description**          |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| `ffuf -h`                                                                                                                                                       | ffuf help                |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ`                                                                                                       | Directory Fuzzing        |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/indexFUZZ`                                                                                                  | Extension Fuzzing        |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php`                                                                                              | Page Fuzzing             |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v`                                                              | Recursive Fuzzing        |
| `ffuf -w wordlist.txt:FUZZ -u https://FUZZ.hackthebox.eu/`                                                                                                      | Sub-domain Fuzzing       |
| `ffuf -w wordlist.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs xxx`                                                                     | VHost Fuzzing            |
| `ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx`                                                                   | Parameter Fuzzing - GET  |
| `ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx` | Parameter Fuzzing - POST |
| `ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx`       | Value Fuzzing            |

# Wordlists

|**Command**|**Description**|
|---|---|
|`/opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt`|Directory/Page Wordlist|
|`/opt/useful/seclists/Discovery/Web-Content/web-extensions.txt`|Extensions Wordlist|
|`/opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt`|Domain Wordlist|
|`/opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt`|Parameters Wordlist|

# Misc

| **Command**                                                                                                                   | **Description**          |
| ----------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| `sudo sh -c 'echo "SERVER_IP academy.htb" >> /etc/hosts'`                                                                     | Add DNS entry            |
| `for i in $(seq 1 1000); do echo $i >> ids.txt; done`                                                                         | Create Sequence Wordlist |
| `curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'` | curl w/                  |

----

Tip: Taking a look at this wordlist we will notice that it contains copyright comments at the beginning, which can be considered as part of the wordlist and clutter the results. We can use the following in `ffuf` to get rid of these lines with the `-ic` flag.


```bash
┌──(pwn㉿kali)-[~]
└─$ cat /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt

```

---

# Directory Fuzzing

```shell-session
MATCHER OPTIONS:
  -mc              Match HTTP status codes, or "all" for everything. (default: 200,204,301,302,307,401,403)
  -ms              Match HTTP response size
```

```bash
┌──(pwn㉿kali)-[~]
└─$ ffuf -u http://83.136.249.101:59172/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt

```

---
# Page Fuzzing
>if the server is `apache`, then it may be `.php`

>`IIS`, then it could be `.asp` or `.aspx`

wordlist:
```shell-session
AhmaDb0x@htb[/htb]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ <SNIP>
```


```bash
AhmaDb0x@htb[/htb]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ
```

## Page Fuzzing
```bash
AhmaDb0x@htb[/htb]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://83.136.249.101:59172/blog/FUZZ.php
```

83.136.249.101:59172/blog/home.php


---

# Recursive Fuzzing
Note: we can still use `.php` as our page extension, as these extensions are usually site-wide.

## Recursive Scanning
```bash
AhmaDb0x@htb[/htb]$ ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://83.136.249.101:59172/FUZZ -recursion -recursion-depth 1 -e .php -v
```


James Fisher.php
```
http://83.136.249.101:59172/forum/flag.php
```


# DNS Records

`/etc/hosts`

`So, in this case, we start looking for sub-domains under '*.academy.htb' and see if we find anything, which is what we will attempt in the next section.`

# Sub-domain Fuzzing
```bash
AhmaDb0x@htb[/htb]$ ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.inlanefreight.com/
```

```bash
AhmaDb0x@htb[/htb]$ ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://FUZZ.academy.htb/
```


---

# Vhost Fuzzing

## Vhosts vs. Sub-domains
fuzzing sub-domains that do not have a public DNS record or sub-domains under websites that are not public, we could not use the same method

>VHost is basically a 'sub-domain' served on the same server and has the same IP

>`single IP could be serving two or more different websites.`

`VHosts may or may not have public DNS records.`

without manually adding the entire wordlist to our `/etc/hosts`, we will be fuzzing HTTP headers, specifically the `Host:` header. To do that, we can use the `-H` flag to specify a header and will use the `FUZZ` keyword within it, as follows:
```bash
AhmaDb0x@htb[/htb]$ ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:43721/ -H 'Host: FUZZ.academy.htb'
```

# Filtering Results
`Ffuf` provides the option to match or filter out a specific HTTP code, response size, or amount of words

```bash
MATCHER OPTIONS:
  -mc              Match HTTP status codes, or "all" for everything. (default: 200,204,301,302,307,401,403)
  -ml              Match amount of lines in response
  -mr              Match regexp
  -ms              Match HTTP response size
  -mw              Match amount of words in response

FILTER OPTIONS:
  -fc              Filter HTTP status codes from response. Comma separated list of codes and ranges
  -fl              Filter by amount of lines in response. Comma separated list of line counts and ranges
  -fr              Filter regexp
  -fs              Filter HTTP response size. Comma separated list of sizes and ranges
  -fw              Filter by amount of words in response. Comma separated list of word counts and ranges
```


```bash
AhmaDb0x@htb[/htb]$ ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs 900
```

Don't forget to add "admin.academy.htb" to "/etc/hosts".

recursive scan on `admin.academy.htb`

# Parameter Fuzzing - GET
```bash
AhmaDb0x@htb[/htb]$ ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:44575/admin/admin.php?FUZZ=key 
```

`http://admin.academy.htb:PORT/admin/admin.php?param1=key`

Similarly to how we have been fuzzing various parts of a website, we will use `ffuf` to enumerate parameters. Let us first start with fuzzing for `GET` requests, which are usually passed right after the URL, with a `?` symbol



# Parameter Fuzzing - POST
The main difference between `POST` requests and `GET` requests is that `POST` requests are not passed with the URL and cannot simply be appended after a `?` symbol. `POST` requests are passed in the `data` field within the HTTP request. Check out the [Web Requests](https://academy.hackthebox.com/module/details/35) module to learn more about HTTP requests.

To fuzz the `data` field with `ffuf`, we can use the `-d` flag, as we saw previously in the output of `ffuf -h`. We also have to add `-X POST` to send `POST` requests.

```bash
AhmaDb0x@htb[/htb]$ ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx
```

```bash
ffuf -u http://target.com/login.php -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "username=FUZZ&password=admin" -w /usr/share/seclists/Usernames/top-usernames-shortlist.txt

```
```shell-session
id  
```
```bash
AhmaDb0x@htb[/htb]$ curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'

<div class='center'><p>Invalid id!</p></div>
<...SNIP...>
```

- `-X POST` → Tells `ffuf` to use a **POST request**.
    
- `-H "Content-Type: application/x-www-form-urlencoded"` → Ensures PHP reads the POST data correctly.
    
- `-d "username=FUZZ&password=admin"` → The `FUZZ` keyword is replaced by usernames from the wordlist.
    
- `-w /usr/share/seclists/Usernames/top-usernames-shortlist.txt` → Uses a wordlist for fuzzing usernames.


---

# Value Fuzzing

```shell-session
AhmaDb0x@htb[/htb]$ for i in $(seq 1 1000); do echo $i >> ids.txt; done
```

```bash
AhmaDb0x@htb[/htb]$ ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx
```

```bash
AhmaDb0x@htb[/htb]$ curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=73' -H 'Content-Type: application/x-www-form-urlencoded'

```
We see that we get a hit right away. We can finally send another `POST` request using `curl`, as we did in the previous section, use the `id` value we just found, and collect the flag

---


43721
archive                 [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 79ms]
test                    [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 4859ms]
faculty

extension fuzzing
```
`http://faculty.academy.htb:PORT/courses/linux-security.php7`
`http://faculty.academy.htb:PORT/courses/linux-security.php7`
```

---

multiple parameters that are accepted by the page
```
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:43721/courses/linux-security.php7?FUZZ=key

user
```
```bash
ffuf -w  /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:43721/courses/linux-security.php7 -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' 
username
```

---

fuzzing the parameters:
```bash
ffuf -w /usr/share/seclists/Usernames/Names/names.txt:FUZZ -u http://faculty.academy.htb:43721/courses/linux-security.php7 -X POST -d 'username=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 781
```
harry

```bash
curl http://faculty.academy.htb:43721/courses/linux-security.php7 -X POST -d 'username=harry' -H 'Content-Type: application/x-www-form-urlencoded'
```
